riot.tag2("app",'<div class="box-white-container"> <div class="box-white-body"> <label class="box-white-label"> <span class="box-label-content">我要借</span> </label> <div class="box-loan"> <div class="box-loan-content"> <div class="box-loan-sign"><span class="box-sign-yen">&yen;</span></div> <div class="box-loan-input" if="{step==0}"> <input type="tel" name="loan" class="box-loan-number" onkeydown="{watchstate}" onkeyup="{watchman}"> </div> <div class="box-loan-input" if="{step> 0}"> <input type="tel" name="loan" class="box-loan-number" riot-value="{userInput}" disabled> </div> </div> </div> <div class="box-loan-rate"> 按日计息，日利率：<span>{currentrate}%</span> </div> </div> <div class="section-stage" if="{showInfo}"> <list onclick="{handleSelect}"> <div class="columns"> <div class="item-title column is-one-third">分期期数</div> <div class="item-title column is-two-third">{number}个月</div> <div class="item-after" if="{(step==0)}"> </div> </div> </list> <div class="box-stage" if="{describe}"> <div class="columns"> <div class="column is-one-third"> 首次还款 </div> <div class="column is-two-third"> &yen;{describe.firstRepayAmt} ({describe.firstRepayDay}) </div> </div> <div class="columns"> <div class="column is-one-third"> 还款日 </div> <div class="column is-two-third"> 每月{describe.repayDay}日 </div> </div> <div class="columns"> <div class="column is-one-third"> 还款详情 </div> <div class="column is-two-third"> <span class="link" onclick="{overview}">查看</span> </div> </div> <div class="columns"> <div class="column is-full"> 次日起即可提前还款,仅按日收取借期利息 </div> </div> </div> </div> <div if="{(step>= 1)}"> <div class="box-radius"> <div class="box-radius-line"></div> </div> <list class="box-card-box"> <div class="columns"> <div class="item-title column"> <div class="box-card"> <label class="box-card-label"><span>收款银行卡</span></label> <list onclick="{handleBank}"> <div class="columns"> <div class="item-title column is-one-third"> <span class="bank-icon" riot-style="background-image: url({bankInfo.url}); "></span> {bankInfo.bankName} {bankInfo.bankType} ({bankInfo.lastNumber}) </div> <div class="item-after" if="{(bankCanSelected && step==1)}"> </div> </div> </list> <div class="box-card-tail"> <div class="box-tail-tips">每月{describe.repayDay}日凌晨从此卡自动扣款</div> <div class="box-card-list" onclick="{overviewBank}">查看支持银行</div> </div> </div> </div> </div> </list> </div> <div if="{(step==2)}"> <list class="box-vertify" if="{needCheck}"> <div class="columns"> <div class="item-title column"> <div class="box-vertify-container"> <label class="box-vertify-label"><span>身份核实</span></label> <div class="box-vertify-username"> <div class="box-username"> <span class="box-username-first">{debitDetail.familyName}</span> </div> <div class="box-username"> <input type="text" onkeyup="{confirmName}" placeholder="补全你的名字" class="name"> </div> </div> <div class="box-vertify-identify"> <div class="box-identify"> <span class="box-identify-code">{debitDetail.bankCardPrePart}</span> </div> <div class="box-identify"> <input type="text" onkeydown="{watchIdentify}" onkeyup="{confirmIdentify}" placeholder="补全身份证后四位" class="identify"> </div> </div> </div> </div> </div> </list> <div class="main-container"> <div class="main-card"> <div class="card-header"> <div class="card-title"> 借款详单 </div> </div> <div class="card-body"> <div class="columns"> <div class="column label is-one-thirds">借款金额</div> <div class="column summary is-two-thirds">&yen;{debitDetail.loadAmt}</div> </div> <div class="columns"> <div class="column label is-one-thirds">收款账户</div> <div class="column summary is-two-thirds">{debitDetail.accessAccount}</div> </div> <div class="columns"> <div class="column label is-one-thirds">贷款利率</div> <div class="column summary is-two-thirds">{debitDetail.loanRate}%</div> </div> <div class="columns"> <div class="column label is-one-thirds">起止时间</div> <div class="column summary is-two-thirds">{debitDetail.startTime}--{debitDetail.endTime}</div> </div> <div class="columns"> <div class="column label is-one-thirds">首次还款日</div> <div class="column summary is-two-thirds">{debitDetail.firstRepayDay}</div> </div> <div class="arrow-area" id="getMore" onclick="{toggleDetail}" if="{needCheck}"> <i class="get-more-icon"></i> </div> <div id="tDetail" class="{hidden:needCheck}"> <div class="columns"> <div class="column label is-one-thirds">借款人姓名</div> <div class="column summary is-two-thirds"> <span if="{(!needCheck)}">{debitTrailDetail.fullName}</span> <span if="{needCheck}">{debitDetail.familyName}</span> </div> </div> <div class="columns"> <div class="column label is-one-thirds">借款人身份证</div> <div class="column summary is-two-thirds"> <span if="{(!needCheck)}">{debitTrailDetail.idNo}</span> <span if="{needCheck}">{debitDetail.bankCardPrePart}</span> </div> </div> <div if="{(!needCheck)}"> <div class="columns"> <div class="column label is-one-thirds">还款日</div> <div class="column summary is-two-thirds">每月{debitTrailDetail.repayDay}日</div> </div> <div class="columns"> <div class="column label is-one-thirds">借款期限</div> <div class="column summary is-two-thirds">{debitTrailDetail.repayPeriod}个月</div> </div> <div class="columns"> <div class="column label is-one-thirds">借款用途</div> <div class="column summary is-two-thirds">{debitTrailDetail.purpose}</div> </div> <div class="columns"> <div class="column label is-one-thirds">还款银行卡</div> <div class="column summary is-two-thirds">{debitTrailDetail.repayAccount}</div> </div> <div class="columns"> <div class="column label is-one-thirds">贷款发放人</div> <div class="column summary is-two-thirds">{debitTrailDetail.loanLender}</div> </div> </div> </div> </div> <div class="{card-tail:true,hidden:needCheck}"> <p class="card-tail-news">请仔细阅读本借据信息，点击确认借钱表示您同意遵守<span onclick="{overviewContract}">《合同及相关协议》</span></p> </div> </div> </div> </div> <div class="box-white-button"> <div class="submit-btn" onclick="{handleNext}" if="{canNext()}">下一步</div> <div class="submit-btn disabled" if="{cannotNext()}">下一步</div> <div class="submit-btn disabled" onclick="{handleSubmit}" if="{(step==2 && needCheck)}">确认借款</div> <div class="submit-btn" onclick="{handleSubmit}" if="{(step==2 && (!needCheck))}">确认借款</div> </div> </div> <img src="assets/images/sawtooth_icon.png" alt="" class="sawtooth">',"","",function(i){function s(i){return i<500?(t=$.tips({content:"单笔借款金额需不低于¥500",stayTime:2e3}),!1):i%100!=0?(t=$.tips({content:"借款金额需为100的整数倍",stayTime:2e3}),!1):void 0}this.showInfo=!1,this.step=0,this.maxCountLimit;var e=this;this.toggleDetail=function(){$("#getMore").hide(),$(".card-tail").removeClass("hidden"),$("#tDetail").removeClass("hidden")}.bind(this),this.scrollBottom=function(){var i=$("#page").height()-$(document.window).height();i>0&&$("body").scrollTop(i)}.bind(this),this.userInput,this.canNext=function(){return this.step<2&&this.showInfo}.bind(this),this.cannotNext=function(){return this.step<2&&!this.showInfo}.bind(this),this.handleNext=function(){if(!this.showInfo){var i=$(".box-loan-number").val();return i?(s(i),!1):(t=$.tips({content:"请先确认金额",stayTime:2e3}),!1)}if(0==this.step){var e=$(".box-loan-number").val();this.userInput=e;nativeJS.oneStepCommit(e);return!1}if(1==this.step){nativeJS.twoStepCommit();return!1}}.bind(this),this.handleSubmit=function(i){if(this.needCheck){if($(i.currentTarget).hasClass("disabled"))return nativeJS.alert("请输入正确的核实身份信息"),!1;var s=$(".name").val(),e=$(".identify").val();nativeJS.comfirmDebit(s,e)}else nativeJS.comfirmDebit("","")}.bind(this);var t,a;this.watchstate=function(i){window.clearTimeout(a),t&&$(t).hide(),8!=i.keyCode&&("*"!=i.key&&"#"!=i.key||i.preventDefault(),i.keyCode>=48&&i.keyCode<=57||i.keyCode>=96&&i.keyCode<=105||i.preventDefault())}.bind(this),this.watchman=function(i){i.currentTarget.value=i.currentTarget.value.replace(/\D/g,"");i.currentTarget.value;a=window.setTimeout(function(){var i=parseInt($(".box-loan-number").val());i?i<500?(this.update({showInfo:!1}),t=$.tips({content:"单笔借款金额需不低于¥500",stayTime:2e3}),nativeJS.hiderepayPlanModule()):i%100!=0?(this.update({showInfo:!1}),t=$.tips({content:"借款金额需为100的整数倍",stayTime:2e3}),nativeJS.hiderepayPlanModule()):i>e.maxCountLimit?(this.update({showInfo:!1}),t=$.tips({content:"借款金额大于可借额度",stayTime:2e3}),nativeJS.hiderepayPlanModule()):(this.update({showInfo:!0}),nativeJS.rePayPlanCalculateRequest(i)):this.update({showInfo:!1})}.bind(this),1e3)}.bind(this),window.maxLimit=function(i){e.maxCountLimit=parseInt(i)};new Array(48,49,50,51,52,53,54,55,56,57,96,97,98,99,100,101,102,103,104,105,8,13);this.watchIdentify=function(i){}.bind(this),this.confirmIdentify=function(i){(i.currentTarget.value.length>4&&(i.currentTarget.value=i.currentTarget.value.substring(0,4)),4==(""+i.currentTarget.value).length)?$(".name").val()&&$(".submit-btn").removeClass("disabled"):$(".submit-btn").addClass("disabled")}.bind(this),this.confirmName=function(i){i.currentTarget.value?4==(""+$(".identify").val()).length&&$(".submit-btn").removeClass("disabled"):$(".submit-btn").addClass("disabled")}.bind(this),this.handleBank=function(){if(1!=this.step)return!1;this.bankCanSelected&&nativeJS.bankCardList("bottom")}.bind(this),this.overviewBank=function(){nativeJS.lookSupportBanks()}.bind(this),this.overviewContract=function(){var i={protType:"T004",title:"合同及相关协议"},s=JSON.stringify(i);nativeJS.clickProtocol(s)}.bind(this),window.back=function(){e.update({needCheck:!0});var i=e.step;i>0?(i--,e.update({step:i}),0==i&&e.update({showInfo:!1}),e.update({debitTrailDetail:null,debitDetailOrder:null}),e.update()):nativeJS.close()},this.handleSelect=function(){0==this.step&&nativeJS.periodsNumber("bottom")}.bind(this),this.overview=function(){nativeJS.rePayPlanList()}.bind(this),this.currentrate="0.05",window.rate=function(i){e.update({currentrate:i})},this.number=10,this.describe,window.rePayPlanDesc=function(i){var s=JSON.parse(i);e.update({describe:s}),e.update({showInfo:!0}),e.update({number:s.periodsNumber})},window.periodsNumber=function(i){e.update({number:i})},this.bankInfo,this.bankCanSelected=!1,window.bankCardSelected=function(i){var s=JSON.parse(i);e.update({bankInfo:s});var t=1==s.isCanChange;e.update({step:1,bankCanSelected:t}),e.scrollBottom()},this.debitDetail,this.needCheck=!0,window.debitDetailOrder=function(i){var s=JSON.parse(i);e.update({debitDetail:s});var t="01"==s.needCheckID;t&&$(".submit-btn").addClass("disabled"),e.update({step:2,needCheck:t}),e.scrollBottom()},this.debitTrailDetail,window.debitDetailOrderTrailPart=function(i){var s=JSON.parse(i);e.update({debitTrailDetail:s}),e.update({needCheck:!1}),e.scrollBottom()},this.on("mount",function(){nativeJS.onPageFinish()})});